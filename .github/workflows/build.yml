name: CI for HarfBuzz::Shaper

on: push

jobs:

  build:
    strategy:
      fail-fast: false
      matrix:
        os:
          - ubuntu-latest
          - macos-latest
          - macos-15-intel
          - windows-latest

    runs-on: ${{ matrix.os }}

    steps:

      - name: Checkout
        uses: actions/checkout@v4

      - name: Install Perl
        uses: shogo82148/actions-setup-perl@v1
        with:
          distribution: strawberry
      - run: perl -V

      - if: ${{ contains(matrix.os,'ubuntu') }}
        name: Install HarfBuzz
        run: |
          sudo apt-get update
          sudo apt-get install -y libharfbuzz-dev

      - name: Install Dependencies
        run: cpanm --installdeps --notest .

      - name: Build, test and install Harfbuzz::Shaper
        run: cpanm .
